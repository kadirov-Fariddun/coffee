;
(self.AMP=self.AMP||[]).push({m:1,v:"2304132133000",n:"amp-image-lightbox",ev:"0.1",l:!0,f:function(t,i){(()=>{var i;function s(){return i||(i=Promise.resolve(void 0))}var h=class{constructor(){this.promise=new Promise(((t,i)=>{this.resolve=t,this.reject=i}))}},{isArray:n}=Array;function e(t,i){const s=[];let h=0;for(let n=0;n<t.length;n++){const e=t[n];i(e,n,t)?s.push(e):(h<n&&(t[h]=e),h++)}return h<t.length&&(t.length=h),s}function r(t){return"string"==typeof t}var{hasOwnProperty:o,toString:a}=Object.prototype;function c(t,i,s,h){return n=>u.solveYValueFromXValue(n,0,0,t,i,s,h,1,1)}var u=class{static solveYValueFromXValue(t,i,s,h,n,e,r,o,a){return u.vr(u.Er(t,i,h,e,o),s,n,r,a)}static Er(t,i,s,h,n){const e=1e-6;let r=(t-i)/(n-i);if(r<=0)return 0;if(r>=1)return 1;let o=0,a=1,c=0;for(let l=0;l<8;l++){c=u.Tr(r,i,s,h,n);const l=(u.Tr(r+e,i,s,h,n)-c)/e;if(Math.abs(c-t)<e)return r;if(Math.abs(l)<e)break;c<t?o=r:a=r,r-=(c-t)/l}for(let l=0;Math.abs(c-t)>e&&l<8;l++)c<t?(o=r,r=(r+a)/2):(a=r,r=(r+o)/2),c=u.Tr(r,i,s,h,n);return r}static Tr(t,i,s,h,n){if(0==t)return i;if(1==t)return n;let e=u.Ir(i,s,t),r=u.Ir(s,h,t);const o=u.Ir(h,n,t);return e=u.Ir(e,r,t),r=u.Ir(r,o,t),u.Ir(e,r,t)}static vr(t,i,s,h,n){if(0==t)return i;if(1==t)return n;let e=u.Ir(i,s,t),r=u.Ir(s,h,t);const o=u.Ir(h,n,t);return e=u.Ir(e,r,t),r=u.Ir(r,o,t),u.Ir(e,r,t)}static Ir(t,i,s){return t+s*(i-t)}},l={LINEAR:t=>t,EASE:t=>u.solveYValueFromXValue(t,0,0,.25,.1,.25,1,1,1),EASE_IN:t=>u.solveYValueFromXValue(t,0,0,.42,0,1,1,1,1),EASE_OUT:t=>u.solveYValueFromXValue(t,0,0,0,0,.58,1,1,1),EASE_IN_OUT:t=>u.solveYValueFromXValue(t,0,0,.42,0,.58,1,1,1)},f={"linear":l.LINEAR,"ease":l.EASE,"ease-in":l.EASE_IN,"ease-out":l.EASE_OUT,"ease-in-out":l.EASE_IN_OUT};function m(t){if(!t)return null;if(r(t)){if(-1!=(t=t).indexOf("cubic-bezier")){const i=t.match(/cubic-bezier\((.+)\)/);if(i){const t=i[1].split(",").map(parseFloat);if(4==t.length){for(let i=0;i<4;i++)if(isNaN(t[i]))return null;return c(t[0],t[1],t[2],t[3])}}return null}return f[t]}return t}function d(t){return 1==(null==(i=t)?void 0:i.nodeType)?(t=t).tagName.toLowerCase()+(t.id?`#${t.id}`:""):t;var i}function _(t,i,s,h,n,e,r,o,a,c,u){return t}function p(t,i,s,h,n,r,o,a,c,u,l){return function(t,i,s="Assertion failed",h){var n,r;if(i)return i;t&&-1==s.indexOf(t)&&(s+=t);let o=3;const a=s.split("%s");let c=a.shift();const u=[c];for(;a.length;){const t=arguments[o++],i=a.shift();c+=d(t)+i,u.push(t,i.trim())}const l=new Error(c);throw l.messageArray=e(u,(t=>""!==t)),null===(n=(r=self).__AMP_REPORT_ERROR)||void 0===n||n.call(r,l),l}("​​​",t,i,s,h,n,r,o,a,c,u,l)}function g(t){return(t.ownerDocument||t).defaultView}function A(t){_(/^[\w-]+$/.test(t))}function M(t,i,s,h){return{left:t,top:i,width:s,height:h,bottom:i+h,right:t+s,x:t,y:i}}function P(t){return M(Number(t.left),Number(t.top),Number(t.width),Number(t.height))}function v(t,i,s,h){const e=n(r=t)?r:[r];var r;for(const t of e){const n=i.getAttribute(t);null!==n?s.setAttribute(t,n):h&&s.removeAttribute(t)}}var E,b=/(\S+)(?:\s+(?:(-?\d+(?:\.\d+)?)([a-zA-Z]*)))?\s*(?:,|$)/g,T=class{constructor(t){p(t.length>0,"Srcset must have at least one source"),this.fw=t;let i=!1,s=!1;for(let h=0;h<t.length;h++){const n=t[h];i=i||!!n.width,s=s||!!n.dpr}p(!(i===s),"Srcset must have width or dpr sources, but not both"),t.sort(i?I:R),this.pw=i}select(t,i){_(t),_(i);let s=0;return s=this.pw?this.mw(t*i):this.dw(i),this.fw[s].url}mw(t){const i=this.fw;let s=0,h=1/0,n=1/0;for(let r=0;r<i.length;r++){var e;const o=null!==(e=i[r].width)&&void 0!==e?e:0,a=Math.abs(o-t);if(!(a<=1.1*h||t/n>1.2))break;s=r,h=a,n=o}return s}dw(t){const i=this.fw;let s=0,h=1/0;for(let n=0;n<i.length;n++){const e=Math.abs(i[n].dpr-t);if(!(e<=h))break;s=n,h=e}return s}getUrls(){return this.fw.map((t=>t.url))}stringify(t){const i=[],s=this.fw;for(let h=0;h<s.length;h++){const n=s[h];let e=n.url;t&&(e=t(e)),this.pw?e+=` ${n.width}w`:e+=` ${n.dpr}x`,i.push(e)}return i.join(", ")}};function I(t,i){return p(t.width!=i.width,"Duplicate width: %s",t.width),t.width-i.width}function R(t,i){return p(t.dpr!=i.dpr,"Duplicate dpr: %s",t.dpr),t.dpr-i.dpr}function V(t){const i=Object.getOwnPropertyDescriptor(t,"message");if(null!=i&&i.writable)return t;const{message:s,stack:h}=t,n=new Error(s);for(const i in t)n[i]=t[i];return n.stack=h,n}function w(t){let i=null,s="";for(const t of arguments)t instanceof Error&&!i?i=V(t):(s&&(s+=" "),s+=t);return i?s&&(i.message=s+": "+i.message):i=new Error(s),i}function y(t,...i){const s=w.apply(null,i);s.name=t||s.name,function(t){var i,s;null===(i=(s=self).__AMP_REPORT_ERROR)||void 0===i||i.call(s,t)}(s)}var x=["Webkit","webkit","Moz","moz","ms","O","o"];function S(t,i,s,h,n){const e=function(t,i,s){if(i.startsWith("--"))return i;E||(E=Object.create(null));let h=E[i];if(!h||s){if(h=i,void 0===t[i]){const s=function(t){return t.charAt(0).toUpperCase()+t.slice(1)}(i),n=function(t,i){for(let s=0;s<x.length;s++){const h=x[s]+i;if(void 0!==t[h])return h}return""}(t,s);void 0!==t[n]&&(h=n)}s||(E[i]=h)}return h}(t.style,i,n);if(!e)return;const r=h?s+h:s;t.style.setProperty(function(t){const i=t.replace(/[A-Z]/g,(t=>"-"+t.toLowerCase()));return x.some((t=>i.startsWith(t+"-")))?`-${i}`:i}(e),r)}function D(t,i){for(const s in i)S(t,s,i[s])}function k(t){return`${t}px`}function C(t,i){return"number"==typeof t?i(t):t}function X(t,i){return null==i?`translate(${C(t,k)})`:`translate(${C(t,k)}, ${C(i,k)})`}function O(t){return`scale(${t})`}function Y(t,i=" "){return(s,h)=>t.map((t=>t(s,h))).filter(r).join(i)}function z(t,i){return(s,h)=>{for(const e in i)S(t,("display"===(n=e)&&y("STYLE","`display` style detected. You must use toggle instead."),n),i[e](s,h));var n}}function $(t,i){return s=>t+(i-t)*s}function Z(t,i){return s=>X(t(s),null==i?void 0:i(s))}function L(t){return i=>O(t(i))}function N(t,i,s){return _(i<=s),Math.min(Math.max(t,i),s)}function B(t,i,s,h){return _(i<=s),N(t,i-h,s+h)}function U(t,i){return Math.sqrt(t*t+i*i)}self.__AMP_LOG=self.__AMP_LOG||{user:null,dev:null,userForEmbed:null};var G=self.__AMP_LOG;function F(t,i){throw new Error("failed to call initLogConstructor")}function H(t){return F()}function j(){return G.dev||(G.dev=F())}function W(t,i,s,h,n,e,r,o,a,c,u){return t}function q(t,i){return Q(t=function(t){return t.__AMP_TOP||(t.__AMP_TOP=t)}(t),i)}function J(t){return t.nodeType?(i=g(t),q(i,"ampdoc")).getAmpDoc(t):t;var i}function K(t){const i=J(t);return i.isSingleDoc()?i.win:i}function Q(t,i){W(tt(t,i));const s=function(t){let i=t.__AMP_SERVICES;return i||(i=t.__AMP_SERVICES={}),i}(t)[i];return s.obj||(W(s.ctor),W(s.context),s.obj=new s.ctor(s.context),W(s.obj),s.context=null,s.resolve&&s.resolve(s.obj)),s.obj}function tt(t,i){const s=t.__AMP_SERVICES&&t.__AMP_SERVICES[i];return!(!s||!s.ctor)}var it,st=t=>Q(t,"timer"),ht=t=>q(t,"vsync"),nt="Animation",et=function(){},rt=class{static animate(t,i,s,h){return new rt(t).setCurve(h).add(0,i,1).start(s)}constructor(t,i){this.Mr=t,this.Rr=i||ht(self),this.yr=null,this.wr=[]}setCurve(t){return t&&(this.yr=m(t)),this}add(t,i,s,h){return this.wr.push({delay:t,func:i,duration:s,curve:m(h)}),this}start(t){return new ot(this.Rr,this.Mr,this.wr,this.yr,t)}},ot=class{constructor(t,i,s,n,e){this.Rr=t,this.Mr=i,this.wr=[];for(let t=0;t<s.length;t++){const i=s[t];this.wr.push({delay:i.delay,func:i.func,duration:i.duration,curve:i.curve||n,started:!1,completed:!1})}this.br=e,this.er=Date.now(),this.Le=!0,this.wi={};const r=new h;this.Vr=r.promise,this.le=r.resolve,this.Sr=r.reject,this.Or=this.Rr.createAnimTask(this.Mr,{mutate:this.Cr.bind(this)}),this.Rr.canAnimate(this.Mr)?this.Or(this.wi):this.kr(!1,0)}then(t,i){return t||i?this.Vr.then(t,i):this.Vr}thenAlways(t){const i=t||et;return this.then(i,i)}halt(t){this.kr(!1,t||0)}kr(t,i){if(this.Le){if(this.Le=!1,0!=i){this.wr.length>1&&this.wr.sort(((t,i)=>t.delay+t.duration-(i.delay+i.duration)));try{if(i>0)for(let t=0;t<this.wr.length;t++)this.wr[t].func(1,!0);else for(let t=this.wr.length-1;t>=0;t--)this.wr[t].func(0,!1)}catch(i){j().error(nt,"completion failed: "+i,i),t=!1}}t?this.le():this.Sr()}}Cr(t){if(!this.Le)return;const i=Date.now(),s=Math.min((i-this.er)/this.br,1);for(let t=0;t<this.wr.length;t++){const i=this.wr[t];!i.started&&s>=i.delay&&(i.started=!0)}for(let t=0;t<this.wr.length;t++){const i=this.wr[t];i.started&&!i.completed&&this.Nr(i,s)}1==s?this.kr(!0,0):this.Rr.canAnimate(this.Mr)?this.Or(this.wi):this.kr(!1,0)}Nr(t,i){let s,h;if(t.duration>0){if(s=Math.min((i-t.delay)/t.duration,1),h=s,t.curve&&1!=h)try{h=t.curve(s)}catch(t){return j().error(nt,"step curve failed: "+t,t),void this.kr(!1,0)}}else s=1,h=1;1==s&&(t.completed=!0);try{t.func(h,t.completed)}catch(t){return j().error(nt,"step mutate failed: "+t,t),void this.kr(!1,0)}}};function at(t){return!!(t.complete||"complete"==t.readyState||function(t){return"AUDIO"===t.tagName||"VIDEO"===t.tagName}(t)&&t.readyState>0||t.document&&"complete"==t.document.readyState)}var ct=class{constructor(){this.ti=null}add(t){return this.ti||(this.ti=[]),this.ti.push(t),()=>{this.remove(t)}}remove(t){this.ti&&function(t,i){const s=t.indexOf(i);-1!=s&&t.splice(s,1)}(this.ti,t)}removeAll(){this.ti&&(this.ti.length=0)}fire(t){if(this.ti)for(const i of this.ti.slice())i(t)}getHandlerCount(){var t,i;return null!==(t=null===(i=this.ti)||void 0===i?void 0:i.length)&&void 0!==t?t:0}},ut="__AMP_Gestures",lt=class{static get(t,i=!1,s=!1){let h=t[ut];return h||(h=new lt(t,i,s),t[ut]=h),h}constructor(t,i=!1,s=!1){this.Of=t,this.xS=[],this.t_=[],this.vi=[],this.MS=[],this.wS=null;const h=function(t){if(void 0!==it)return it;it=!1;try{const i={get passive(){return it=!0,!1}};t.addEventListener("test-options",null,i),t.removeEventListener("test-options",null,i)}catch(t){}return it}(t.ownerDocument.defaultView);this.IS=i||h,this.RS=s,this.VS=!1,this.$e=new class{constructor(t,i,s){this.Oe=st(t),this.Ce=i,this.ke=s||0,this.Ne=-1,this.De=0,this.Le=!1,this.Ue=()=>{this.$e()}}isPending(){return-1!=this.Ne}schedule(t){let i=t||this.ke;this.Le&&i<10&&(i=10);const s=Date.now()+i;return(!this.isPending()||s-this.De<-10)&&(this.cancel(),this.De=s,this.Ne=this.Oe.delay(this.Ue,i),!0)}$e(){this.Ne=-1,this.De=0,this.Le=!0,this.Ce(),this.Le=!1}cancel(){this.isPending()&&(this.Oe.cancel(this.Ne),this.Ne=-1)}}(g(t),this.Qd.bind(this)),this.kS=new ct,this.SS=Object.create(null),this.OS=this.Wp.bind(this),this.CS=this.Kp.bind(this),this.zS=this.Qp.bind(this),this.NS=this.h_.bind(this),this.Of.addEventListener("touchstart",this.OS,!!h&&{passive:!0}),this.Of.addEventListener("touchend",this.CS),this.Of.addEventListener("touchmove",this.zS,!!h&&{passive:!0}),this.Of.addEventListener("touchcancel",this.NS),this.LS=!1}cleanup(){this.Of.removeEventListener("touchstart",this.OS),this.Of.removeEventListener("touchend",this.CS),this.Of.removeEventListener("touchmove",this.zS),this.Of.removeEventListener("touchcancel",this.NS),delete this.Of[ut],this.$e.cancel()}onGesture(t,i){const s=new t(this),h=s.getType();let n=this.SS[h];return n||(this.xS.push(s),n=new ct,this.SS[h]=n),n.add(i)}removeGesture(t){const i=new t(this).getType(),s=this.SS[i];if(s){s.removeAll();const t=function(t,s){for(let s=0;s<t.length;s++)if(t[s].getType()==i)return s;return-1}(this.xS);return!(t<0||(this.xS.splice(t,1),this.vi.splice(t,1),this.MS.splice(t,1),this.t_.splice(t,1),delete this.SS[i],0))}return!1}onPointerDown(t){return this.kS.add(t)}Wp(t){const i=Date.now();this.VS=!1,this.kS.fire(t);for(let s=0;s<this.xS.length;s++)this.vi[s]||(this.MS[s]&&this.MS[s]<i&&this.o_(s),this.xS[s].onTouchStart(t)&&this.u_(s));this.DS(t)}Qp(t){const i=Date.now();for(let s=0;s<this.xS.length;s++)this.t_[s]&&(this.MS[s]&&this.MS[s]<i?this.o_(s):this.xS[s].onTouchMove(t)||this.o_(s));this.DS(t)}Kp(t){const i=Date.now();for(let s=0;s<this.xS.length;s++){if(!this.t_[s])continue;if(this.MS[s]&&this.MS[s]<i){this.o_(s);continue}this.xS[s].onTouchEnd(t);const h=!this.MS[s],n=this.MS[s]<i;this.wS==this.xS[s]||!h&&!n||this.o_(s)}this.DS(t)}h_(t){for(let t=0;t<this.xS.length;t++)this.US(t);this.DS(t)}Xp(t,i){if(this.wS)return void t.acceptCancel();const s=Date.now();for(let h=0;h<this.xS.length;h++)this.xS[h]==t&&(this.vi[h]=s+i,this.MS[h]=0);this.LS=!0}$S(t,i){if(this.wS)return void t.acceptCancel();const s=Date.now();for(let h=0;h<this.xS.length;h++)this.xS[h]==t&&(this.MS[h]=s+i)}jS(t){this.wS==t&&(this.wS=null,this.VS=!0)}FS(t,i,s){_(this.wS==t);const h=this.SS[t.getType()];h&&h.fire(new class{constructor(t,i,s,h){this.type=t,this.data=i,this.time=s,this.event=h}}(t.getType(),i,Date.now(),s))}DS(t){let i=!!this.wS||this.VS;if(this.VS=!1,!i){const t=Date.now();for(let s=0;s<this.xS.length;s++)if(this.vi[s]||this.MS[s]&&this.MS[s]>=t){i=!0;break}}i?(t.stopPropagation(),this.IS||t.preventDefault()):this.RS&&t.stopPropagation(),this.LS&&(this.LS=!1,this.Qd())}Qd(){const t=Date.now();let i=-1;for(let s=0;s<this.xS.length;s++)this.vi[s]?(-1==i||this.vi[s]>this.vi[i])&&(i=s):this.MS[s]&&this.MS[s]<t&&this.o_(s);if(-1==i)return;let s=0;for(let i=0;i<this.xS.length;i++)!this.vi[i]&&this.t_[i]&&(s=Math.max(s,this.MS[i]-t));s<2?this.HS(i):this.$e.schedule(s)}HS(t){const i=this.xS[t];for(let i=0;i<this.xS.length;i++)i!=t&&this.US(i);this.vi[t]=0,this.MS[t]=0,this.wS=i,i.acceptStart()}u_(t){this.t_[t]=!0,this.MS[t]=0}o_(t){this.t_[t]=!1,this.MS[t]=0,this.vi[t]||this.xS[t].acceptCancel()}US(t){this.vi[t]=0,this.o_(t)}},ft=class{constructor(t,i){this.vz=t,this.V_=i}getType(){return this.vz}signalReady(t){this.V_.Xp(this,t)}signalPending(t){this.V_.$S(this,t)}signalEnd(){this.V_.jS(this)}signalEmit(t,i){this.V_.FS(this,t,i)}acceptStart(){}acceptCancel(){}onTouchStart(t){return!1}onTouchMove(t){return!1}onTouchEnd(t){}},mt=function(){},dt=.02,_t=Math.round(-16.67/Math.log(.95));function pt(t,i,s){i<1&&(i=1);const h=t/i,n=.5+Math.min(i/33.34,.5);return h*n+s*(1-n)}function gt(t,i,s,h,n,e,r){return new At(t,i,s,h,n,e,r).start()}var At=class{constructor(t,i,s,n,e,r,o){this.Rr=o||ht(self),this.Mr=t,this.st=r,this.wz=i,this.Iz=s,this.xZ=n,this.zZ=e,this.Oz=0,this.Cz=0;const a=new h;this.Vr=a.promise,this.le=a.resolve,this.Sr=a.reject,this.SZ=!1}start(){return this.SZ=!0,Math.abs(this.xZ)<=dt&&Math.abs(this.zZ)<=dt?(this.kZ(),this.CZ(!0)):this.DZ(),this}halt(){this.SZ&&this.CZ(!1)}then(t,i){return t||i?this.Vr.then(t,i):this.Vr}thenAlways(t){const i=t||mt;return this.then(i,i)}DZ(){this.Oz=this.xZ,this.Cz=this.zZ;const t=this.XZ.bind(this),i=this.CZ.bind(this,!0);return this.Rr.runAnimMutateSeries(this.Mr,t,5e3).then(i,i)}XZ(t,i){if(!this.SZ)return!1;if(this.wz+=i*this.Oz,this.Iz+=i*this.Cz,!this.kZ())return!1;const s=Math.exp(-t/_t);return this.Oz=this.xZ*s,this.Cz=this.zZ*s,Math.abs(this.Oz)>dt||Math.abs(this.Cz)>dt}CZ(t){this.SZ&&(this.SZ=!1,this.kZ(),t?this.le():this.Sr())}kZ(){return this.st(this.wz,this.Iz)}},Mt=class extends ft{constructor(t){super("tap",t),this.xz=0,this.Mz=0,this.wz=0,this.Iz=0,this.o=null}onTouchStart(t){const{touches:i}=t;return this.o=t.target,!(!i||1!=i.length||(this.xz=i[0].clientX,this.Mz=i[0].clientY,0))}onTouchMove(t){const i=t.changedTouches||t.touches;if(i&&1==i.length){this.wz=i[0].clientX,this.Iz=i[0].clientY;const t=Math.abs(this.wz-this.xz)>=8,s=Math.abs(this.Iz-this.Mz)>=8;if(t||s)return!1}return!0}onTouchEnd(t){this.signalReady(0)}acceptStart(){this.signalEmit({clientX:this.wz,clientY:this.Iz,target:this.o},null),this.signalEnd()}},Pt=class extends ft{constructor(t){super("doubletap",t),this.xz=0,this.Mz=0,this.wz=0,this.Iz=0,this.ZX=0,this.GX=null}onTouchStart(t){if(this.ZX>1)return!1;const{touches:i}=t;return!(!i||1!=i.length||(this.xz=i[0].clientX,this.Mz=i[0].clientY,this.wz=i[0].clientX,this.Iz=i[0].clientY,0))}onTouchMove(t){const{touches:i}=t;if(i&&1==i.length){this.wz=i[0].clientX,this.Iz=i[0].clientY;const t=Math.abs(this.wz-this.xz)>=8,s=Math.abs(this.Iz-this.Mz)>=8;return!t&&!s||(this.acceptCancel(),!1)}return!1}onTouchEnd(t){this.ZX++,this.ZX<2?this.signalPending(200):(this.GX=t,this.signalReady(0))}acceptStart(){this.ZX=0,this.signalEmit({clientX:this.wz,clientY:this.Iz},this.GX),this.signalEnd()}acceptCancel(){this.ZX=0}},vt=class extends ft{constructor(t,i,s,h){super(t,i),this.Tz=s,this.Ez=h,this.wS=!1,this.xz=0,this.Mz=0,this.wz=0,this.Iz=0,this.Rz=0,this.Vz=0,this.er=0,this.kz=0,this.Sz=0,this.Oz=0,this.Cz=0}onTouchStart(t){const{touches:i}=t;return!!(this.wS&&i&&i.length>1)||!(!i||1!=i.length)&&(this.er=Date.now(),this.xz=i[0].clientX,this.Mz=i[0].clientY,!0)}onTouchMove(t){const{touches:i}=t;if(i&&i.length>=1){const{clientX:s,clientY:h}=i[0];if(this.wz=s,this.Iz=h,this.wS)this.zz(!1,!1,t);else{const t=Math.abs(s-this.xz),i=Math.abs(h-this.Mz);if(this.Tz&&this.Ez)(t>=8||i>=8)&&this.signalReady(-10);else if(this.Tz){if(t>=8&&t>i)this.signalReady(-10);else if(i>=8)return!1}else{if(!this.Ez)return!1;if(i>=8&&i>t)this.signalReady(-10);else if(t>=8)return!1}}return!0}return!1}onTouchEnd(t){const{touches:i}=t;i&&0==i.length&&this.Nz(t)}acceptStart(){this.wS=!0,this.Rz=this.xz,this.Vz=this.Mz,this.Sz=this.er,this.xz=this.wz,this.Mz=this.Iz,this.zz(!0,!1,null)}acceptCancel(){this.wS=!1}zz(t,i,s){this.kz=Date.now();const h=this.kz-this.Sz;if(!i&&h>4||i&&h>16){const t=pt(this.wz-this.Rz,h,this.Oz),s=pt(this.Iz-this.Vz,h,this.Cz);(!i||h>32||0!=t||0!=s)&&(this.Oz=Math.abs(t)>1e-4?t:0,this.Cz=Math.abs(s)>1e-4?s:0),this.Rz=this.wz,this.Vz=this.Iz,this.Sz=this.kz}this.signalEmit({first:t,last:i,time:this.kz,deltaX:this.wz-this.xz,deltaY:this.Iz-this.Mz,startX:this.xz,startY:this.Mz,lastX:this.wz,lastY:this.Iz,velocityX:this.Oz,velocityY:this.Cz},s)}Nz(t){this.wS&&(this.wS=!1,this.zz(!1,!0,t),this.signalEnd())}},Et=class extends vt{constructor(t){super("swipe-xy",t,!0,!0)}},bt=class extends ft{constructor(t){super("tapzoom",t),this.wS=!1,this.xz=0,this.Mz=0,this.wz=0,this.Iz=0,this.ZX=0,this.Rz=0,this.Vz=0,this.kz=0,this.Sz=0,this.Oz=0,this.Cz=0}onTouchStart(t){if(this.wS)return!1;const{touches:i}=t;return!(!i||1!=i.length||(this.xz=i[0].clientX,this.Mz=i[0].clientY,0))}onTouchMove(t){const{touches:i}=t;if(i&&1==i.length){if(this.wz=i[0].clientX,this.Iz=i[0].clientY,this.wS)this.zz(!1,!1,t);else{const t=Math.abs(this.wz-this.xz)>=8,i=Math.abs(this.Iz-this.Mz)>=8;if(t||i){if(0==this.ZX)return this.acceptCancel(),!1;this.signalReady(0)}}return!0}return!1}onTouchEnd(t){this.wS?this.Nz(t):(this.ZX++,1!=this.ZX?this.acceptCancel():this.signalPending(400))}acceptStart(){this.ZX=0,this.wS=!0,this.zz(!0,!1,null)}acceptCancel(){this.ZX=0,this.wS=!1}zz(t,i,s){this.kz=Date.now(),t?this.Oz=this.Cz=0:this.kz-this.Sz>2&&(this.Oz=pt(this.wz-this.Rz,this.kz-this.Sz,this.Oz),this.Cz=pt(this.Iz-this.Vz,this.kz-this.Sz,this.Cz)),this.Rz=this.wz,this.Vz=this.Iz,this.Sz=this.kz,this.signalEmit({first:t,last:i,centerClientX:this.xz,centerClientY:this.Mz,deltaX:this.wz-this.xz,deltaY:this.Iz-this.Mz,velocityX:this.Oz,velocityY:this.Cz},s)}Nz(t){this.wS&&(this.wS=!1,this.zz(!1,!0,t),this.signalEnd())}},Tt=new Set(["amp-img","amp-anim","img"]),It=["aria-label","aria-describedby","aria-labelledby"],Rt=c(.4,0,.2,1),Vt=c(.4,0,.2,1),wt=c(.4,0,.2,1.4),yt=class extends t.BaseElement{constructor(t){super(t),this.lY=-1,this.YD=!1,this.Y$=!1,this.Z$=null,this.J$=null,this.K$=null,this.Rf=null,this.Q$=null,this.OZ=null,this.aY=this.cY.bind(this),this.registerDefaultAction((t=>this.KB(t)),"open")}buildCallback(){var t;(t=this.element,function(t,i){const s=K(J(t));return tt(s,i)?Q(s,i):null}(t,"action")).addToAllowlist("AMP-IMAGE-LIGHTBOX","open",["email"])}$Z(){if(this.Rf)return;this.Rf=this.element.ownerDocument.createElement("div"),this.Rf.classList.add("i-amphtml-image-lightbox-container"),this.element.appendChild(this.Rf),this.Q$=new class{constructor(t,i,s){this.ZZ=t,this.win=i,this.$i=s,this.Ye=t.element.ownerDocument.createElement("div"),this.Ye.classList.add("i-amphtml-image-lightbox-viewer"),this.LZ=t.element.ownerDocument.createElement("img"),this.LZ.classList.add("i-amphtml-image-lightbox-viewer-image"),this.Ye.appendChild(this.LZ),this.NZ=null,this.YY=0,this.OY=0,this.BZ=M(0,0,0,0),this.UZ=M(0,0,0,0),this.jY=1,this.HY=1,this.GZ=1,this.LY=1,this.$Y=2,this.xz=0,this.Mz=0,this.FY=0,this.qY=0,this.JY=0,this.KY=0,this.QY=0,this.XN=0,this.ZN=null,this.DX()}getElement(){return this.Ye}getImage(){return this.LZ}getViewerBox(){return this.BZ}getImageBox(){return this.UZ}getImageBoxWithOffset(){return 0==this.FY&&0==this.qY?this.UZ:(t=this.UZ,i=this.FY,s=this.qY,0==i&&0==s||0==t.width&&0==t.height?t:M(t.left+i,t.top+s,t.width,t.height));var t,i,s}reset(){this.LZ.setAttribute("src",""),It.forEach((t=>{this.LZ.removeAttribute(t)})),this.LZ.removeAttribute("aria-describedby"),this.NZ=null,this.UZ=M(0,0,0,0),this.YY=0,this.OY=0,this.GZ=1,this.jY=1,this.HY=1,this.$Y=2,this.xz=0,this.Mz=0,this.FY=0,this.qY=0,this.JY=0,this.KY=0,this.QY=0,this.XN=0,this.ZN&&this.ZN.halt(),this.ZN=null}FZ(t,i){i?(this.YY=i.naturalWidth||t.offsetWidth,this.OY=i.naturalHeight||t.offsetHeight):(this.YY=t.offsetWidth,this.OY=t.offsetHeight)}init(t,i){this.FZ(t,i),this.NZ=function(t){const i=t.getAttribute("srcset");if(i)return function(t){const i=[];let s;for(;s=b.exec(t);){const t=s[1];let h,n;if(s[2]){const t=s[3].toLowerCase();if("w"==t)h=parseInt(s[2],10);else{if("x"!=t)continue;n=parseFloat(s[2])}}else n=1;i.push({url:t,width:h,dpr:n})}return new T(i)}(i);const s=t.getAttribute("src");return p(s,'Either non-empty "srcset" or "src" attribute must be specified: %s',t),new T([{url:s,width:void 0,dpr:1}])}(t),"img"===t.tagName.toLowerCase()?v(It,t,this.LZ):t.getImpl().then((t=>v(It,t.element,this.LZ))),i&&at(i)&&i.src&&this.LZ.setAttribute("src",i.src)}measure(){this.BZ=P(this.Ye.getBoundingClientRect());const t=this.YY/this.OY;let i=Math.min(this.BZ.width/t,this.BZ.height),s=Math.min(this.BZ.height*t,this.BZ.width);Math.abs(s-this.YY)<=16&&Math.abs(i-this.OY)<=16&&(s=this.YY,i=this.OY),this.UZ=M(Math.round((this.BZ.width-s)/2),Math.round((this.BZ.height-i)/2),Math.round(s),Math.round(i)),D(this.LZ,{top:k(this.UZ.top),left:k(this.UZ.left),width:k(this.UZ.width),height:k(this.UZ.height)});const h=this.BZ.width/this.BZ.height,n=Math.max(h/t,t/h);return this.$Y=Math.max(2,n),this.HY=this.jY=1,this.xz=this.FY=0,this.Mz=this.qY=0,this.QN(this.jY),this.AZ(),this.xM()}xM(){if(!this.NZ)return s();this.GZ=Math.max(this.GZ,this.jY);const t=this.UZ.width*this.GZ,i=this.NZ.select(t,class{static getTop(t){return t.top}static getLocation(t){return t.location}static getDocumentReferrer(t){return t.document.referrer}static getHostname(t){return t.location.hostname}static getUserAgent(t){return t.navigator.userAgent}static getUserLanguage(t){return t.navigator.userLanguage||t.navigator.language}static getDevicePixelRatio(){return self.devicePixelRatio||1}static getSendBeacon(t){if(t.navigator.sendBeacon)return t.navigator.sendBeacon.bind(t.navigator)}static getXMLHttpRequest(t){return t.XMLHttpRequest}static getImage(t){return t.Image}}.getDevicePixelRatio());return i==this.LZ.getAttribute("src")?s():st(this.win).promise(1).then((()=>(this.LZ.setAttribute("src",i),this.$i(this.LZ))))}DX(){const t=lt.get(this.LZ);t.onGesture(Mt,(()=>{this.ZZ.toggleViewMode()})),t.onGesture(Et,(t=>{this.EZ(t.data.deltaX,t.data.deltaY,!1),t.data.last&&this.IZ(t.data.velocityX,t.data.velocityY)})),t.onPointerDown((()=>{this.ZN&&this.ZN.halt()})),t.onGesture(Pt,(t=>{let i;i=1==this.jY?this.$Y:this.LY;const s=this.BZ.width/2-t.data.clientX,h=this.BZ.height/2-t.data.clientY;this.YZ(i,s,h,!0).then((()=>this.hZ(0,0,0,0,0,0)))})),t.onGesture(bt,(t=>{this.HZ(t.data.centerClientX,t.data.centerClientY,t.data.deltaX,t.data.deltaY),t.data.last&&this.hZ(t.data.centerClientX,t.data.centerClientY,t.data.deltaX,t.data.deltaY,t.data.velocityY,t.data.velocityY)}))}wZ(t,i){return B(t,this.LY,this.$Y,i?.25:0)}tZ(t,i){return B(t,this.JY,this.QY,i&&this.jY>1?.25*this.BZ.width:0)}sZ(t,i){return B(t,this.KY,this.XN,i?.25*this.BZ.height:0)}QN(t){let i=0,s=0;const h=this.BZ.height-this.UZ.height*t;h>=0?s=i=0:(s=h/2,i=-s);let n=0,e=0;const r=this.BZ.width-this.UZ.width*t;r>=0?e=n=0:(e=r/2,n=-e),this.JY=e,this.KY=s,this.QY=n,this.XN=i}AZ(){D(this.LZ,{transform:X(this.FY,this.qY)+" "+O(this.jY)}),1!=this.jY&&this.ZZ.toggleViewMode(!0)}EZ(t,i,s){const h=this.tZ(this.xz+t,!0),n=this.sZ(this.Mz+i,!0);this.iZ(this.jY,h,n,s)}IZ(t,i){const s=this.qY-this.Mz;1==this.jY&&Math.abs(s)>10?this.ZZ.close():(this.ZN=gt(this.LZ,this.FY,this.qY,t,i,((t,i)=>{const s=this.tZ(t,!0),h=this.sZ(i,!0);return!(Math.abs(s-this.FY)<1&&Math.abs(h-this.qY)<1||(this.iZ(this.jY,s,h,!1),0))})),this.ZN.thenAlways((()=>(this.ZN=null,this.TZ()))))}HZ(t,i,s,h){const n=U(s,h),e=Math.abs(h)>Math.abs(s)?Math.sign(h):Math.sign(-s);if(0==e)return;const r=this.HY*(1+e*n/100),o=this.BZ.width/2-t,a=this.BZ.height/2-i;s=Math.min(o,o*(n/100)),h=Math.min(a,a*(n/100)),this.YZ(r,s,h,!1)}YZ(t,i,s,h){const n=this.wZ(t,!0);if(n==this.jY)return;this.QN(n);const e=this.tZ(this.xz+i*n,!1),r=this.sZ(this.Mz+s*n,!1);return this.iZ(n,e,r,h)}hZ(t,i,h,n,e,r){let o;o=0==e&&0==r?s():gt(this.LZ,h,n,e,r,((s,h)=>(this.HZ(t,i,s,h),!0))).thenAlways();const a=this.jY>this.HY;return o.then((()=>this.TZ())).then((()=>{a&&this.xM()}))}iZ(t,i,h,n){const e=t-this.jY,r=(o=this.FY,a=this.qY,U(i-o,h-a));var o,a;let c,u=0;if(n){const t=250;u=Math.min(t,Math.max(t*r*.01,t*Math.abs(e)))}if(u>16&&n){const s=$(this.jY,t),n=$(this.FY,i),e=$(this.qY,h);c=rt.animate(this.LZ,(t=>{this.jY=s(t),this.FY=n(t),this.qY=e(t),this.AZ()}),u,wt).thenAlways((()=>{this.jY=t,this.FY=i,this.qY=h,this.AZ()}))}else this.jY=t,this.FY=i,this.qY=h,this.AZ(),c=n?s():void 0;return c}TZ(){const t=this.wZ(this.jY,!1);t!=this.jY&&this.QN(t);const i=this.tZ(this.FY/this.jY*t,!1),s=this.sZ(this.qY/this.jY*t,!1);return this.iZ(t,i,s,!0).then((()=>{this.HY=this.jY,this.xz=this.FY,this.Mz=this.qY}))}}(this,this.win,this.loadPromise.bind(this)),this.Rf.appendChild(this.Q$.getElement()),this.OZ=this.element.ownerDocument.createElement("div"),this.OZ.setAttribute("id",this.element.getAttribute("id")+"-caption"),this.OZ.classList.add("amp-image-lightbox-caption"),this.OZ.classList.add("i-amphtml-image-lightbox-caption"),this.Rf.appendChild(this.OZ);const t=this.element.ownerDocument.createElement("button"),i=this.element.getAttribute("data-close-button-aria-label")||"Close the lightbox";t.textContent=i,t.classList.add("i-amphtml-screen-reader"),t.tabIndex=-1,t.addEventListener("click",(()=>{this.close()})),this.element.appendChild(t);const h=lt.get(this.element);this.element.addEventListener("click",(t=>{this.Y$||this.Q$.getImage().contains(t.target)||this.close()})),h.onGesture(Mt,(()=>{this.Y$||this.close()})),h.onGesture(Et,(()=>{}))}KB(t){if(this.YD)return;this.$Z();const i=t.caller,s=i.tagName.toLowerCase();var h,n;h=i&&Tt.has(s),n=i.tagName,(G.user||(G.user=H()),void G.user.win?G.userForEmbed||(G.userForEmbed=H()):G.user).assert(h,"Unsupported element: %s",n,undefined,undefined,undefined,undefined,undefined,undefined,undefined,undefined),this.YD=!0,this.se(),this.xu(i),this.win.document.documentElement.addEventListener("keydown",this.aY),this.getViewport().enterLightboxMode(),this.U_(),this.K$=this.getViewport().onChanged((()=>{var t;this.YD&&((t=this.win,q(t,"platform")).getIosVersionString().startsWith("10.3")?st(this.win).delay((()=>{this.Q$.measure()}),500):this.Q$.measure())})),this.WX().push(this.close.bind(this)).then((t=>{this.lY=t}))}cY(t){"Escape"==t.key&&(t.preventDefault(),this.close())}close(){this.YD&&(this.YD=!1,this.Y$=!1,this.B_(),this.K$&&(this.K$(),this.K$=null),this.getViewport().leaveLightboxMode(),-1!=this.lY&&this.WX().pop(this.lY),this.win.document.documentElement.removeEventListener("keydown",this.aY),this.Z$&&function(t){try{t.focus()}catch(t){}}(this.Z$))}toggleViewMode(t){void 0!==t?this.Rf.classList.toggle("i-amphtml-image-lightbox-view-mode",t):this.Rf.classList.toggle("i-amphtml-image-lightbox-view-mode")}xu(t){var i;this.Z$=t,this.J$=(i=t,A("img"),i.querySelector("> img".replace(/^|,/g,"$&:scope "))),this.Q$.init(this.Z$,this.J$);let s=null;const h=t.closest("figure");if(h&&(n=h,A(e="figcaption"),s=n.querySelector(e)),!s){const i=t.getAttribute("aria-describedby");s=this.element.ownerDocument.getElementById(i)}var n,e;s&&(function(t,i){const s=i.ownerDocument.createDocumentFragment();for(let i=t.firstChild;i;i=i.nextSibling)s.appendChild(i.cloneNode(!0));i.appendChild(s)}(s,this.OZ),this.Q$.getImage().setAttribute("aria-describedby",this.OZ.getAttribute("id"))),this.OZ.classList.toggle("i-amphtml-empty",!s)}se(){this.Q$.reset(),function(t){for(;t.firstChild;)t.removeChild(t.firstChild)}(this.OZ),this.Z$=null,this.J$=null,this.toggleViewMode(!1)}U_(){var t,i;this.Y$=!0,t=this.element,void 0===(i=!0)&&(i=t.hasAttribute("hidden")),i?t.removeAttribute("hidden"):t.setAttribute("hidden",""),D(this.element,{opacity:0}),this.Q$.measure();const s=new rt(this.element);s.add(0,z(this.element,{opacity:$(0,1)}),.6,Rt);let h=null;if(this.J$&&at(this.J$)&&this.J$.src){h=this.element.ownerDocument.createElement("div"),h.classList.add("i-amphtml-image-lightbox-trans"),this.getAmpDoc().getBody().appendChild(h);const t=P(this.J$.getBoundingClientRect()),i=this.Q$.getImageBox(),n=this.J$.cloneNode(!0);n.className="",D(n,{position:"absolute",top:k(t.top),left:k(t.left),width:k(t.width),height:k(t.height),transformOrigin:"top left",willChange:"transform"}),h.appendChild(n),this.J$.classList.add("i-amphtml-ghost");const e=i.left-t.left,r=i.top-t.top,o=0!=t.width?i.width/t.width:1,a=N(Math.abs(r)/250*.8,.2,.8);s.add(0,z(n,{transform:Y([Z($(0,e),$(0,r)),L($(1,o))])}),a,Rt),D(this.Rf,{opacity:0}),s.add(.8,z(this.Rf,{opacity:$(0,1)}),.1,Rt),s.add(.9,z(h,{opacity:$(1,.01)}),.1,Vt)}return s.start(500).thenAlways((()=>{this.Y$=!1,D(this.element,{opacity:""}),D(this.Rf,{opacity:""}),h&&this.getAmpDoc().getBody().removeChild(h)}))}B_(){const t=this.Q$.getImage(),i=this.Q$.getImageBoxWithOffset(),s=new rt(this.element);let h=500;s.add(0,z(this.element,{opacity:$(1,0)}),.9,Vt);let n=null;if(at(t)&&t.src&&this.J$){n=this.element.ownerDocument.createElement("div"),n.classList.add("i-amphtml-image-lightbox-trans"),this.getAmpDoc().getBody().appendChild(n);const e=P(this.J$.getBoundingClientRect()),r=t.cloneNode(!0);D(r,{position:"absolute",top:k(i.top),left:k(i.left),width:k(i.width),height:k(i.height),transform:"",transformOrigin:"top left",willChange:"transform"}),n.appendChild(r),s.add(0,z(this.Rf,{opacity:$(1,0)}),.1,Vt);const o=e.left-i.left,a=e.top-i.top,c=0!=i.width?e.width/i.width:1,u=z(r,{transform:Y([Z($(0,o),$(0,a)),L($(1,c))])}),l=N(Math.abs(a)/250*.8,.2,.8);s.add(Math.min(.8-l,.2),((t,i)=>{u(t),i&&this.J$.classList.remove("i-amphtml-ghost")}),l,Vt),s.add(.8,z(n,{opacity:$(1,.01)}),.2,Vt),h=N(Math.abs(a)/250*h,300,h)}return s.start(h).thenAlways((()=>{this.J$&&this.J$.classList.remove("i-amphtml-ghost"),this.collapse(),D(this.element,{opacity:""}),D(this.Rf,{opacity:""}),n&&this.getAmpDoc().getBody().removeChild(n),this.se()}))}WX(){return function(t,i){return Q(K(J(t)),"history")}(this.getAmpDoc())}};t.registerElement("amp-image-lightbox",yt,"amp-image-lightbox{position:fixed!important;top:0!important;left:0!important;bottom:0!important;right:0!important;margin:0!important;padding:0!important;overflow:hidden!important;transform:translateZ(0)!important;-ms-touch-action:none!important;touch-action:none!important;z-index:1000;background:rgba(0,0,0,0.95);color:#f2f2f2}.i-amphtml-image-lightbox-container{position:absolute;z-index:0;top:0;left:0;right:0;bottom:0;overflow:hidden;transform:translateZ(0)}.i-amphtml-image-lightbox-trans{pointer-events:none!important;position:fixed;z-index:1001;top:0;left:0;bottom:0;right:0}.i-amphtml-image-lightbox-caption{position:absolute!important;z-index:2;bottom:0!important;left:0!important;right:0!important}.i-amphtml-image-lightbox-caption.i-amphtml-empty,.i-amphtml-image-lightbox-view-mode .i-amphtml-image-lightbox-caption{visibility:hidden}.amp-image-lightbox-caption{background:rgba(0,0,0,0.5);max-height:25%;padding:8px}.i-amphtml-image-lightbox-viewer{position:absolute;z-index:1;top:0;left:0;right:0;bottom:0;overflow:hidden;transform:translateZ(0)}.i-amphtml-image-lightbox-viewer-image{position:absolute;z-index:1;display:block;transform-origin:50% 50%}\n/*# sourceURL=/extensions/amp-image-lightbox/0.1/amp-image-lightbox.css*/")})();
/*! https://mths.be/cssescape v1.5.1 by @mathias | MIT license */}});
//# sourceMappingURL=amp-image-lightbox-0.1.mjs.map